<!DOCTYPE html><html lang="en-US"><head>
<title>Incomplete page</title>
<style>
#fileDisplayArea {
  background-color: lightblue;
  border: 1px solid black;
}
</style>
<script>
function fileApi_adom1() {
fileDisplayArea.innerHTML+='fileApi_adom1() start';
  //help the popup start in a familiar directory
  String filePath = new File("").getAbsolutePath();
  //alert('fileApi_adom1 2');
  filePath.concat(fileInput.files[0]);
  //alert('fileApi_adom1 3');
  var file = fileInput.files[0];
  //alert('fileApi_adom1 4');
  var textType = /text.*/; 
  //alert('fileApi_adom1 5');
  if (file.type.match(textType)) {
    alert('file type matched');
    var reader = new FileReader(); 
    reader.onload = function(e) {
      alert('reader.onload 1');
      fileDisplayArea.innerText = reader.result; //the filename  
      alert('reader.onload 2');
      theContent=reader.readAsText(file);
      //alert('reader.onload 3');
      alert('theContent='+theContent);
      alert('reader.onload 4');
      } //end reader.onload
    var newArr = JSON.parse(theContent);
    alert(newArr);
    fileDisplayArea.innerText=reader.readAsText(file);
    } else { //end if begin else
      alert('file type didn't match.');
      fileDisplayArea.innerText = "File not supported!" 
    } //end else
} //end function

//Old code:
//  var file1 = new File([""], fName, {type: "text/plain"});
//  var fr = new FileReader();
//  fr.onload=function() {
//    alert('fr.onload called');
//    temp1 = fr.readAsText(file1);
//    temp2 = fr.result; // display file contents 
//    alert('temp1='+temp1.toString());
//    alert('temp2='+temp2.toString());
//  }
//alert('fileApi_adom1() ending');
</script>
<script>
/* An error was reported in 2 browsers for retrieving local file. Different internet reports conflicted about pulling files with fetch. If it does local files and does that accomplish Matthew 25:20-21? */

function fetchApi_adom(fName) {
  alert('fetchApi start, received filename'+fName);
fetch(fName) 
.then(function(response) {
  alert('fetch .then(response) ok');
})
.catch(function(error) {
  alert('Looks like there was a problem: \n', error);
});
alert('fetchApi ending');
} //end function
</script>
<script>
/* Waiting for the page to load hoped to avoid anomalies from processing something not yet available. */
/*There are 2 parts. function AfterLoad_adom1() is listed first, and after the function, code for the first level listeners */

function AfterLoad_adom1() {
  alert('AfterLoad_adom1() starting.');

//set listener for fileApi. ?change vs click
fileInput.addEventListener("change", fileApi_adom1);
fileInput.addEventListener("click", function(){ this.value=null; fileDisplayArea.innerHTML = "set value to null";});
}// end function



fileInput = document.getElementById('fileInput');
fileDisplayArea = document.getElementById('fileDisplayArea');
if(window.addEventListener){
try {
  window.addEventListener('load', AfterLoad_adom1);
} //end try
catch(err) {
    errM='error in window.addEventListener(), message='+err.message;
    window.alert(errM);
    //errR.innerText=errM;
} //end catch
} //end if
else{
try {
  //In case someone or an international browser tries to run internet explorer (IE) 8, there is unique code
  window.attachEvent('onload', AfterLoad_adom1);
} //end try
catch(err) {
    errM='error in window.attachEvent(), message='+err.message;
    window.alert(errM);
    //errR.innerText=errM;
} //end catch
}
</script>
</head><body>
<div id="google_translate_element"></div>
<h1 id="top">Incomplete web page(s) - under construction.</h1>
<p>The functionality is not yet completed-under construction.</p>

<br><br>
<br>
<div id="RA_status"></div><script>checks_adom();</script>

<hr>

<h2>Not complete: attempt to apply the FileReader API to count and verify verses.</h2>
<div> Select a text file:
<input type="file" id="fileInput"></div>
<pre id="fileDisplayArea"><pre>
</body></html>

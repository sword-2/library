<!DOCTYPE html><html lang="en-US"><head>
<title>Incomplete page</title>
<style>
#RA_status {
  border: 1px solid green;
}

#fileDisplayArea {
  background-color: lightblue;
  border: 1px solid black;
}
</style>
<script>
/* Some lines of code were commented out after a perceived risk that no file.type was being reported. This was based on simple debugging output. It was hoped to protect the operator from unexpected files, but the type reporting will have to be figured out first */

//a global variable for brefspec file

function fileApi_adom1() {
  var file = brefspec.files[0];
  //RA_status.innerHTML+='<br><br>debugging fileApi_adom1()....';
    //RA_status.innerHTML+='<br>file.name='+file.name;
    //RA_status.innerHTML+='<br>file.type='+file.type;

  //type check skipped after not finding file.type
  //var patt = /text/i;
  //if (file.type.match(patt)) {
    var reader = new FileReader();
    var brefspec; //global variable for content
    reader.onload = function(e) {
      brefspec = e.target.result;
      fileDisplayArea.innerHTML=brefspec;
    }; //end reader.onload
    reader.readAsText(file);
  //} else { //end if begin else
    //RA_status.innerHTML+='<br>File type check not successful, expected some type of text. Searched with pattern:' +patt.toString()+', on file.type='+file.type;
  //} //end else
  RA_status.innerHTML+='<br>fileApi_adom1() ending';
  return brefspec;
} //end function
</script>
<script>
/* An error was reported in 2 browsers for retrieving local file. Different internet reports conflicted about pulling files with fetch. If it does local files and does that accomplish Matthew 25:20-21? */

function fetchApi_adom(fName) {
  alert('fetchApi start, received filename'+fName);
fetch(fName) 
.then(function(response) {
  alert('fetch .then(response) ok');
})
.catch(function(error) {
Â  alert('Looks like there was a problem: \n', error);
});
alert('fetchApi ending');
} //end function
</script>
<script>

function checks_adom() {
//Attempt to check some of what is needed to run program

//variables to document elements
brefspec = document.getElementById('brefspec');
fileDisplayArea = document.getElementById('fileDisplayArea');
RA_status = document.getElementById("RA_status");

//function return values
var cntinue=true; //chg false on error
var status1='Checking which elements and APIs are supported..........'; //return a result


status1+='<br><br>First checking elements ....';
if (RA_status) {
  status1+='<br>found: RA_status.';
} else {
  status1+='<br>NOT found: RA_status element. It is needed to status other elements, APIs, etc.';
  cntinue=false;
}
if (brefspec) {
  status1+='<br>found: brefspec.';
} else {
  status1+='<br>NOT found: brefspec.';
  cntinue=false;
}
if (fileDisplayArea) {
  status1+='<br>found: fileDisplayArea.';
} else {
  status1+='<br>NOT found: fileDisplayArea.';
  cntinue=false;
}

status1+='<br><br>Checking APIs ....';
//File and related APIs
if (window.File && window.FileReader && window.FileList && window.Blob) {
  status1+='<br>found: File, FileReader, FileList, & Blob APIs.';
} else {
  status1+='<br>NOT found: File, FileReader, FileList, & Blob APIs.';
cntinue=false;
}

if ('fetch' in window) {
  status1+='<br>found: Fetch API';
} else {
  status1+='<br>NOT found: Fetch API';
  cntinue=false;
}
return { c: cntinue, status: status1, };

} //end function
</script>
<script>
/* Waiting for the page to load hoped to avoid anomalies from processing something not yet available. */
/* There are 2 parts. function AfterLoad_adom1() is listed first, and after the function, code for the first level listeners */

function AfterLoad_adom1() {
try {
someRes = checks_adom();
if (someRes.c == false) {
alert('some error found: '+someRes.status);
} else { //OK to process
  RA_status.innerHTML='Basic checks passed as follows:<br>'+someRes.status;
  RA_status.innerHTML+='<br>AfterLoad_adom1(), setting listeners for fileAPi:';
//set listener for fileApi. ?change vs click
brefspec.addEventListener('change', fileApi_adom1);

RA_status.innerHTML+='<br>AfterLoad_adom1(), listener(s) added, end of processing.';
} //end else
} //end try
catch(err) {
    errM='error in window.addEventListener(), message='+err.message;
    window.alert(errM);
} //end catch
}// end AfterLoad_adom1()


if(window.addEventListener){
try {
  window.addEventListener('load', AfterLoad_adom1);
} //end try
catch(err) {
    errM='error in window.addEventListener(), message='+err.message;
    window.alert(errM);
    //errR.innerText=errM;
} //end catch
} //end if
else{
try {
  //In case someone or an international browser tries to run internet explorer (IE) 8, there is unique code
  window.attachEvent('onload', AfterLoad_adom1);
} //end try
catch(err) {
    errM='error in window.attachEvent(), message='+err.message;
    window.alert(errM);
    //errR.innerText=errM;
} //end catch
} //end else for addEventListener/attachEvent
</script>
</head><body>
<h1 id="top">Incomplete web page(s) - under construction.</h1>
<p>The functionality is not yet completed-under construction.</p>


<br><br>
<br>
<div id='RA_status'></div><script>checks_adom();</script>

<hr>

<h2>Not complete: attempt to apply the FileReader API to count and verify verses.</h2>
<div> Select a text file:
<input type='file' id='brefspec'></div>
<pre id='fileDisplayArea'><pre>
</body></html>
